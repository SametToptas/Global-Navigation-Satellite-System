% Abdulsamet Topta≈ü (21905024)
% Epoch = (2 + 1 + 9 + 0 + 5 + 0 + 2 + 4)*750 s = 17250 s = 4 hrs 47 min 30sec
% for March 1, 2023
% trecw = ( 86400 * 3 ) + 17250 = 276450 sec

format longG

doy = 60; % Day of year
trec = 17250; % second of day
trecw = 276450; % second of week

rec = [4239146.6414;  2886967.1245;  3778874.4800]; % Approx Position X,Y,Z

% Klobuchar coefficients (sec sec/semicircle sec/semicircle2 sec/semicircle3)
alpha = [0.2328D-07  0.0000D+00 -0.1192D-06  0.1192D-06]; % ION ALPHA
beta = [0.1290D+06 -0.1638D+05 -0.6554D+05 -0.5243D+06]; % ION BETA


% there are 10 satellites in my own epoch;
% SP3 Matrices for All Related Satellite
% PG(any number) = G(any number)
SP3_G04 = [13500 986.338551  24376.615803  10373.420063    -17.191555;
    14400 523.421024  25336.792913   7768.657254    -17.183944;
    15300 161.750087  26020.889947   5029.372492    -17.176323;
    16200 -131.581378  26408.668883   2202.965236    -17.168725;
    17100 -392.473468  26488.326501   -661.613879    -17.161145;
    18000 -658.215260  26256.945443  -3514.727902    -17.153569;
    18900 -965.824589  25720.609764  -6306.932408    -17.145981;
    19800 -1350.398430  24894.180097  -8989.851335    -17.138409;
    20700 -1843.540288  23800.737319 -11517.032894    -17.13083;
    21600 -2471.927893  22470.716986 -13844.769043    -17.123234];
    
SP3_G05 = [13500 5062.660364 -14958.242765  21167.931683   -117.729301;
    14400 7035.949792 -13447.769988  21619.758974   -117.730992;
    15300 9109.043337 -12025.590527  21693.443656   -117.732102;
    16200 11241.166440 -10721.124856  21388.048931   -117.733922;
    17100 13387.489008  -9556.618039  20709.353943   -117.735147;
    18000 15500.733461  -8546.405984  19669.717499   -117.736262;
    18900 17532.881761  -7696.510132  18287.818108   -117.737508;
    19800 19436.912415  -7004.573726  16588.278169   -117.738950;
    20700 21168.498112  -6460.138474  14601.182556   -117.740241;
    21600 22687.597275  -6045.246453  12361.503818   -117.741289];

SP3_G07 = [13500 15851.277784   9772.162738  19549.652773    232.031951;
    14400 13790.351170  10560.427852  20651.721370    232.025433;
    15300 11675.439953  11495.068078  21414.900847    232.019041;
    16200 9550.494755  12568.513338  21825.851185    232.012115;
    17100 7458.133589  13765.579507  21876.706290    232.005669;
    18000 5438.230919  15063.869768  21565.256310    231.998945;
    18900 3526.594624  16434.444921  20895.067980    231.992382;
    19800 1753.776464  17842.746583  19875.536569    231.985692;
    20700 144.059332  19249.748808  18521.862202    231.979061;
    21600 -1285.339025  20613.305208  16854.942809    231.972377];

SP3_G08 = [13500 -6288.598502  25531.378052   1563.528632   -110.773471;
    14400 -6511.951192  25136.133169   4413.624325   -110.775867;
    15300 -6720.420497  24433.233431   7185.822603   -110.777095;
    16200 -6951.029419  23432.627309   9831.223377   -110.778566;
    17100 -7238.669496  22153.146986  12303.257757   -110.780113;
    18000 -7614.516497  20621.834249  14558.563337   -110.781716;
    18900 -8104.608477  18872.945854  16557.787766   -110.782955;
    19800 -8728.645878  16946.681856  18266.302705   -110.785115;
    20700 -9499.062825  14887.692013  19654.813443   -110.786934;
    21600 -10420.406148  12743.424166  20699.853041   -110.789264];

SP3_G09 = [13500 9482.058369  16957.631467  18016.113258   -209.346122;
    14400 8979.423854  18878.335665  16283.349718   -209.339588;
    15300 8599.714860  20610.704705  14268.408941   -209.333013;
    16200 8320.734912  22117.554280  12006.288726   -209.326401;
    17100 8114.512999  23368.001054   9536.268117   -209.319823;
    18000 7948.566870  24338.542160   6901.207444   -209.313249;
    18900 7787.348240  25013.855210   4146.786219   -209.306685;
    19800 7593.811549  25387.288447   1320.693686   -209.300092;
    20700 7331.043254  25461.023192  -1528.212357   -209.293511;
    21600 6963.886584  25245.903842  -4350.762501   -209.286928];

SP3_G13 = [13500 13284.288995 -21778.952147   6841.863989    483.555972;
    14400 13190.349488 -20794.609149   9516.172917    483.561338;
    15300 13070.117406 -19520.779450  12023.700553    483.566482;
    16200 12961.976267 -17973.044038  14320.285946    483.571561;
    17100 12901.613119 -16175.642374  16365.466084    483.576464;
    18000 12920.458871 -14160.679442  18123.238288    483.581896;
    18900 13044.308633 -11967.022009  19562.736131    483.587639;
    19800 13292.180449  -9638.928874  20658.803255    483.592733;
    20700 13675.460394  -7224.471468  21392.452242    483.598019;
    21600 14197.369438  -4773.810040  21751.198957    483.603496];

SP3_G14 = [13500 21815.916511  11062.933917 -10507.016772    -15.617127;
    14400 22417.133697  11965.532771  -7953.830438    -15.608474;
    15300 22835.536187  12647.938299  -5264.763722    -15.599828;
    16200 23038.119756  13127.692039  -2485.788941    -15.591194;
    17100 22997.332625  13428.887705    335.625649    -15.582559;
    18000 22692.211132  13581.065303   3151.309423    -15.573952;
    18900 22109.276138  13617.904993   5913.193263    -15.565322;
    19800 21243.156261  13575.770570   8574.111469    -15.556716;
    20700 20096.914094  13492.157953  11088.589504    -15.548102;
    21600 18682.062436  13404.107586  13413.605513    -15.539467];

SP3_G20 = [13500 14629.083195  -8126.401918  20616.813139    447.797813;
    14400 16533.585536  -6825.112104  19605.040258    447.795833;
    15300 18384.307271  -5682.130380  18255.097977    447.793182;
    16200 20135.599506  -4702.042572  16589.739375    447.791755;
    17100 21742.944175  -3881.458349  14637.273577    447.789645;
    18000 23164.590350  -3209.296739  12431.103770    447.787437;
    18900 24363.102899  -2667.381500  10009.166908    447.785582;
    19800 25306.761475  -2231.324577   7413.283516    447.783281;
    20700 25970.752939  -1871.663801   4688.428472    447.781037;
    21600 26338.108051  -1555.210097   1881.935857    447.779059];

SP3_G27 = [13500 -12619.082844  19945.957113  11512.728871     91.302452;
    14400 -12553.644316  18431.426489  13861.864163     91.294535;
    15300 -12534.194159  16661.943722  15964.122609     91.286606;
    16200 -12592.463410  14669.662956  17782.151644     91.278679;
    17100 -12754.583373  12493.691012  19283.868849     91.270727;
    18000 -13039.913667  10178.668168  20443.069281     91.262764;
    18900 -13460.167831   7773.132897  21239.899819     91.254822;
    19800 -14018.872376   5327.742375  21661.191017     91.246905;
    20700 -14711.179200   2893.425992  21700.641984     91.238941;
    21600 -15524.034805    519.550461  21358.858697     91.230978];

SP3_G30 = [13500 24462.664362    987.937801  10714.143454   -528.637157;
    14400 23268.835656   1650.310292  13035.502763   -528.635944;
    15300 21878.270718   2461.712357  15136.568020   -528.634694;
    16200 20328.786638   3435.258369  16981.705707   -528.633486;
    17100 18661.374738   4576.803522  18539.490816   -528.632212;
    18000 16918.733549   5884.528358  19783.224656   -528.630937;
    18900 15143.745653   7348.813046  20691.385697   -528.629661;
    19800 13377.953172   8952.408458  21248.006436   -528.628362;
    20700 11660.087333  10670.900736  21442.969591   -528.627077;
    21600 10024.706265  12473.455613  21272.217331   -528.625771];

G = {SP3_G04, SP3_G05, SP3_G07, SP3_G08, SP3_G09, SP3_G13, SP3_G14, SP3_G20, SP3_G27, SP3_G30};
SP3 = cat(3, G{:});

% Pseudo Range (C1 = C1C) in Rinex3 file
% epoch = 4 hrs 47 min 30 sec
% (G04 - G05 - G07 - G08 - G09  - G13 - G14 - G20 - G27 - G30)
C1 = [24546098.213; 22890776.296; 21326550.267; 24003520.913; 21745245.432; 24199033.007; 21715793.505; 21540876.174; 24922174.556; 20849784.827];

% Total Group Delay (TGD) is provided in navigation message as Second For
% ALL RELATED SATELLITE
TGD = [-0.465661287308D-08;
    -0.111758708954D-07;
    -0.111758708954D-07;
    0.512227416039D-08;
    0.139698386192D-08;
    -0.111758708954D-07;
    -0.791624188423D-08;
    -0.838190317154D-08;
    0.186264514923D-08;
    0.372529029846D-08];
